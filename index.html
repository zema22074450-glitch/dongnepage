<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>ì¤‘ë‘êµ¬ ë§›ì§‘</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-E2DSWTXYH6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag("js", new Date());
  gtag("config", "G-E2DSWTXYH6");
</script>

<!-- âœ… 1ë‹¨ê³„ ì˜¤í”ˆìš© SEO/ê³µìœ  ê¸°ë³¸ ì„¸íŒ… -->
<meta name="description" content="ë©´ëª©ë™ ì£¼ë¯¼ì´ ì§ì ‘ ê³ ë¥¸ ë™ë„¤ ë§›ì§‘ ëª¨ìŒ. ê´‘ê³ ëŠ” â€˜ê´‘ê³ â€™ë¡œ í‘œì‹œí•©ë‹ˆë‹¤." />
<meta property="og:type" content="website" />
<meta property="og:locale" content="ko_KR" />
<meta property="og:title" content="ì¤‘ë‘êµ¬ ë§›ì§‘" />
<meta property="og:description" content="ì¤‘ë‘êµ¬ ì£¼ë¯¼ì´ ì§ì ‘ ê³ ë¥¸ ë™ë„¤ ë§›ì§‘ ëª¨ìŒ. ê´‘ê³ ëŠ” â€˜ê´‘ê³ â€™ë¡œ í‘œì‹œí•©ë‹ˆë‹¤." />
<meta property="og:url" content="https://dongnepage.netlify.app/" />
<link rel="canonical" href="https://dongnepage.netlify.app/" />

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans KR",Arial,sans-serif;}
:root{
  --bg1:#f8fafc; --bg2:#fffaf5; --text:#0f172a; --muted:#64748b;
  --border:#e5e7eb; --shadow:0 18px 55px rgba(15,23,42,.12);
  --card:#ffffff;
}
body.dark{
  --bg1:#0b1220; --bg2:#0b1220; --text:#f8fafc; --muted:#94a3b8;
  --border:#223047; --shadow:0 18px 55px rgba(0,0,0,.35);
  --card:#0f1a2e;
}
body{min-height:100vh;background:linear-gradient(140deg,var(--bg1),var(--bg2));color:var(--text);}

.topbar{position:sticky;top:0;background:var(--card);border-bottom:1px solid var(--border);z-index:10;}
.topbar-inner{max-width:1200px;margin:0 auto;padding:14px 22px;display:flex;justify-content:space-between;align-items:center;gap:12px;}

/* âœ… ë¸Œëœë“œ(ì‹¬í”Œ) */
.brand{display:flex;align-items:center;gap:10px;font-weight:900;white-space:nowrap;text-decoration:none;color:inherit;}
.logo{width:22px;height:22px;display:grid;place-items:center;}
.logo svg{width:22px;height:22px;display:block}
.brand-text{font-weight:950;letter-spacing:-.2px;font-size:16px;}

.top-actions{display:flex;align-items:center;gap:10px;flex-wrap:wrap;justify-content:flex-end;}

/* ë²„íŠ¼ ê³µí†µ */
.nick-btn,.dark-btn,.contact-btn,.share-btn{
  padding:10px 12px;border-radius:12px;
  font-weight:900;cursor:pointer;
  background:transparent;
  white-space:nowrap;
}
.nick-btn{border:1px solid #2563eb;color:#2563eb;font-weight:800;}
.dark-btn{border:1px solid var(--border);color:var(--text);}
.dark-btn:hover{border-color:#cbd5e1}
.contact-btn{border:1px solid #2563eb;color:#2563eb;}
.contact-btn:hover{opacity:.92}
.share-btn{border:1px solid var(--border);color:var(--text);}
.share-btn:hover{border-color:#cbd5e1}

/* ë¼ë²¨(ëª¨ë°”ì¼ì—ì„œ ì§§ê²Œ) */
.btn-label-long{display:inline;}
.btn-label-short{display:none;}

.container{max-width:1200px;margin:0 auto;padding:26px 22px 22px;display:grid;grid-template-columns:1fr 290px;gap:22px;}
.page-hero{padding:22px;border-radius:22px;background:var(--card);border:1px solid var(--border);box-shadow:var(--shadow);}
.page-title{
  font-size:28px;font-weight:950;
  background:linear-gradient(90deg,#2563eb,#22c55e);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
.subtitle{margin-top:6px;color:var(--muted);font-weight:700;font-size:14px;line-height:1.45;}
.subtitle b{color:var(--text)}
.controls{margin-top:14px;display:flex;gap:10px;flex-wrap:wrap;align-items:center;}
.search{flex:1;min-width:220px;}
.search input{width:100%;padding:12px 14px;border-radius:14px;border:1px solid var(--border);font-weight:700;background:var(--card);color:var(--text);}
.search-link{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:6px;
  margin-top:4px;
  font-size:13px;
  font-weight:800;
  color:#2563eb;
  text-decoration:none;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
  line-height:1.2;
}
.search-link:hover{ text-decoration:underline; }
.search-link:focus-visible{outline:2px solid rgba(37,99,235,.35); outline-offset:2px; border-radius:8px;}
.pill-row{display:flex;gap:8px;flex-wrap:wrap;}
.pill{padding:10px 14px;border-radius:999px;border:1px solid var(--border);background:var(--card);font-weight:800;cursor:pointer;color:var(--text);}
.pill{display:inline-flex;align-items:center;justify-content:center;text-decoration:none;}
.pill.active{background:#2563eb;color:#fff;border-color:#2563eb;}
.sort select{
  padding:12px 14px;border-radius:14px;border:1px solid var(--border);
  font-weight:800;background:var(--card);color:var(--text);cursor:pointer;
}

/* ë°°ë„ˆ */
.banner{
  margin-top:14px;
  border-radius:18px;
  border:1px solid var(--border);
  background:linear-gradient(90deg, rgba(37,99,235,.10), rgba(34,197,94,.10));
  box-shadow:0 12px 30px rgba(15,23,42,.08);
  overflow:hidden;
}
.banner-image{
  width:100%;
  height:auto;
  display:block;
}
body.dark .banner{background:linear-gradient(90deg, rgba(37,99,235,.20), rgba(34,197,94,.20));}
.banner-inner{padding:14px 14px;display:flex;align-items:center;justify-content:space-between;gap:12px;}
.banner-left{display:flex;align-items:center;gap:12px;min-width:0;}
.banner-badge{
  width:44px;height:44px;border-radius:16px;
  background:linear-gradient(135deg, rgba(37,99,235,.25), rgba(34,197,94,.25));
  border:1px solid var(--border);
  display:grid;place-items:center;flex:0 0 auto;
}
.banner-badge svg{width:26px;height:26px;display:block}
.banner-text{display:flex;flex-direction:column;gap:4px;min-width:0;}
.banner-tag{font-size:12px;font-weight:950;color:#2563eb;display:flex;align-items:center;gap:8px;}
.ad-chip{
  font-size:11px;font-weight:950;padding:6px 10px;border-radius:999px;
  background:rgba(0,0,0,.65);color:#fff;display:inline-block;
}
.banner-title{font-size:14px;font-weight:950;color:var(--text);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.banner-sub{font-size:12px;font-weight:800;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.banner-actions{display:flex;gap:8px;flex:0 0 auto;align-items:center;}
.banner-mini{
  padding:10px 12px;border-radius:14px;border:1px solid var(--border);background:var(--card);
  font-weight:950;cursor:pointer;white-space:nowrap;color:var(--text);
}
.banner-mini:hover{border-color:#cbd5e1}

.grid{margin-top:16px;display:grid;grid-template-columns:repeat(3,1fr);gap:18px;}
.card{border-radius:22px;background:var(--card);border:1px solid var(--border);box-shadow:0 14px 35px rgba(15,23,42,.1);overflow:hidden;cursor:pointer;position:relative;}
.card-link{display:block;text-decoration:none;color:inherit;}
.thumb{position:relative;overflow:hidden;background:linear-gradient(180deg,rgba(15,23,42,.04),rgba(15,23,42,.02));aspect-ratio:4/3;}
.thumb img{width:100%;height:100%;object-fit:cover;display:block;position:absolute;inset:0;z-index:1;}
.thumb .img-overlay{
  position:absolute;inset:0;z-index:2;
  background:linear-gradient(180deg, rgba(15,23,42,.00), rgba(15,23,42,.06));
}
.thumb-illus{position:absolute;inset:0;display:block;z-index:1;}
.thumb-illus svg{width:100%;height:100%;display:block;}
.badge{position:absolute;top:12px;left:12px;background:rgba(0,0,0,.65);color:#fff;padding:6px 10px;border-radius:999px;font-size:12px;font-weight:900;z-index:5;}
.badge.ad{left:auto;right:12px;background:rgba(37,99,235,.95);}

/* âœ… í•˜íŠ¸ ì‚´ì§ í¬ê²Œ */
.heart{
  position:absolute;top:12px;right:12px;font-size:24px;cursor:pointer;user-select:none;z-index:6;
  border:none;background:none;padding:0;line-height:1;color:inherit;
}
.heart:focus{outline:2px solid rgba(37,99,235,.35); outline-offset:2px; border-radius:10px;}
.heart.active{color:#ef4444;}
.card.has-ad .heart{top:44px;}

.content{padding:14px;position:relative;}
.name{font-weight:950;color:var(--text);padding-right:62px;}
.desc{font-size:13px;color:var(--muted);margin-top:4px;}
.addr{font-size:12px;color:var(--muted);margin-top:6px;font-weight:800;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.views-mini{margin-top:8px;font-size:12px;font-weight:800;color:var(--muted);}
.detail-btn{
  position:absolute;right:12px;bottom:12px;
  padding:8px 10px;border-radius:999px;border:1px solid var(--border);
  background:var(--card);font-weight:900;font-size:12px;cursor:pointer;color:var(--text);
}
.detail-btn:hover{border-color:#cbd5e1}

.detail-view{
  margin-top:16px;
  border-radius:22px;
  background:var(--card);
  border:1px solid var(--border);
  box-shadow:var(--shadow);
  padding:18px;
  display:none;
}
.detail-view.show{display:block;}
.detail-gallery{
  margin-top:12px;
  display:flex;
  gap:10px;
  overflow-x:auto;
  scroll-snap-type:x mandatory;
  -webkit-overflow-scrolling:touch;
  padding-bottom:4px;
}
.detail-gallery::-webkit-scrollbar{height:6px;}
.detail-gallery::-webkit-scrollbar-thumb{background:rgba(100,116,139,.45);border-radius:999px;}
.detail-slide{
  flex:0 0 100%;
  scroll-snap-align:start;
  border-radius:16px;
  overflow:hidden;
  border:1px solid var(--border);
  background:var(--card);
  aspect-ratio:4/3;
}
.detail-slide img{width:100%;height:100%;object-fit:cover;display:block;}
.detail-meta{font-size:13px;color:var(--muted);font-weight:800;margin-top:6px;}
.detail-desc{margin-top:8px;font-weight:700;color:var(--text);}
.detail-actions{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px;}
.detail-actions a,.detail-actions button{
  padding:10px 12px;border-radius:14px;border:1px solid var(--border);
  background:var(--card);font-weight:900;cursor:pointer;color:var(--text);text-decoration:none;
}
.detail-actions a:hover,.detail-actions button:hover{border-color:#cbd5e1}

/* ì‚¬ì´ë“œ */
.side-card{border-radius:22px;background:var(--card);border:1px solid var(--border);box-shadow:0 12px 30px rgba(15,23,42,.08);overflow:hidden;}
.side-title{padding:14px;font-weight:900;border-bottom:1px solid var(--border);color:var(--text);display:flex;align-items:center;justify-content:space-between;gap:8px;}
.side-title .count{font-size:12px;font-weight:950;color:var(--muted);}
.side-list{padding:14px;font-size:13px;line-height:1.6;color:var(--muted);}
.saved-item{
  display:flex;align-items:center;justify-content:space-between;
  padding:10px 10px;border:1px solid var(--border);border-radius:14px;margin-bottom:8px;
  background:var(--card);cursor:pointer;gap:10px;
}
.saved-item:hover{border-color:#cbd5e1}
.saved-item .left{display:flex;flex-direction:column;gap:2px;min-width:0;flex:1;}
.saved-item .t{font-weight:900;color:var(--text);font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.saved-item .s{font-weight:700;color:var(--muted);font-size:12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.saved-item .right{display:flex;align-items:center;gap:8px;flex:0 0 auto;}
.saved-item .go{font-weight:900;color:#2563eb;font-size:12px;}
.saved-item .x{
  width:28px;height:28px;border-radius:10px;border:1px solid var(--border);
  background:var(--card);color:var(--text);font-weight:950;cursor:pointer;line-height:1;
}
.saved-item .x:hover{border-color:#cbd5e1}

.side-actions{display:flex;gap:8px;padding:0 14px 14px;}
.small-btn{
  flex:1;padding:10px 12px;border-radius:14px;border:1px solid var(--border);
  background:var(--card);font-weight:900;cursor:pointer;color:var(--text);
}
.small-btn.primary{border-color:#2563eb;color:#2563eb;}
.small-btn:hover{border-color:#cbd5e1}
.side-mini-link{
  padding:0 14px 14px;
  font-size:12px;font-weight:900;color:var(--muted);
}
.side-mini-link button{
  border:none;background:none;color:#2563eb;font-weight:950;cursor:pointer;padding:0;margin-left:6px;
}

/* ëª¨ë‹¬ */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.4);display:flex;align-items:center;justify-content:center;z-index:50;}
.modal-box{background:var(--card);padding:22px;border-radius:18px;width:320px;box-shadow:0 18px 55px rgba(15,23,42,.2);border:1px solid var(--border);}
.modal-box h3{font-size:16px;margin-bottom:10px;color:var(--text);}
.modal-box input,.modal-box select,.modal-box textarea{
  width:100%;padding:10px;margin-bottom:8px;border-radius:12px;border:1px solid var(--border);
  font-weight:700;background:var(--card);color:var(--text);
}
.modal-box textarea{resize:none;min-height:72px}
.modal-box button{width:100%;padding:10px;background:#2563eb;color:#fff;border:none;font-weight:900;border-radius:12px;cursor:pointer;}
.modal-row{display:flex;gap:8px;margin-top:8px;}
.modal-row button{width:100%;}
.btn-ghost{background:var(--card) !important;color:var(--text) !important;border:1px solid var(--border) !important;}
.hidden{display:none !important;}

.toast{
  position:fixed;left:50%;bottom:22px;transform:translateX(-50%);
  background:rgba(15,23,42,.92);color:#fff;padding:10px 14px;border-radius:999px;
  font-weight:900;font-size:13px;z-index:80;box-shadow:0 16px 40px rgba(0,0,0,.25);
  opacity:0;pointer-events:none;transition:.18s;
}
.toast.show{opacity:1;transform:translateX(-50%) translateY(-4px);}

.footer{
  max-width:1200px;margin:0 auto;
  padding:14px 22px 40px;
  color:var(--muted);
  font-size:12px;font-weight:800;
  display:flex;flex-wrap:wrap;gap:10px;
  align-items:center;justify-content:space-between;
}
.footer .left{display:flex;flex-wrap:wrap;gap:10px;align-items:center;}
.footer .pill{
  padding:8px 10px;border-radius:999px;border:1px solid var(--border);
  background:var(--card);font-weight:900;font-size:12px;color:var(--text);
}
.footer button{
  border:none;background:none;color:#2563eb;font-weight:950;cursor:pointer;padding:0;
}

@media(max-width:900px){
  .container{grid-template-columns:1fr;}
  .topbar-inner{align-items:flex-start;}
  .grid{grid-template-columns:repeat(2,1fr);}
}

@media(max-width:560px){
  .grid{grid-template-columns:1fr;}
  .banner-actions{flex-direction:column;align-items:stretch;}

  /* âœ… ìƒë‹¨: 1ì¤„(ë™ë„¤ë§›ì§‘+ë‹¤í¬) + 2ì¤„(ë‹‰ë„¤ì„/ê³µìœ ) + 3ì¤„(ë¬¸ì˜) */
  .topbar-inner{
    display:grid;
    grid-template-columns:1fr 1fr;
    grid-template-areas:
      "brand dark"
      "nick share"
      "contact contact";
    gap:10px;
    align-items:center;
  }

  .top-actions{display:contents;}

  .brand{grid-area:brand;justify-self:start;}
  .brand-text{font-size:20px;} /* ë™ë„¤ë§›ì§‘ í¬ê²Œ */

  .dark-btn{grid-area:dark;justify-self:end;}
  .nick-btn{grid-area:nick;}
  .share-btn{grid-area:share;}
  .contact-btn{grid-area:contact;}

  /* ë²„íŠ¼ í¬ê¸°(ì¡°ê¸ˆ ì‘ê²Œ, í„°ì¹˜ì˜ì—­ì€ ìœ ì§€) */
  .nick-btn,.contact-btn,.share-btn,.dark-btn{
    width:100%;
    padding:9px 8px;
    font-size:12px;
    border-radius:14px;
    display:flex;
    align-items:center;
    justify-content:center;
    gap:6px;
  }

  /* ë¬¸ì˜ ì‚´ì§ ê°•ì¡° */
  .contact-btn{
    background:rgba(37,99,235,.10);
    border-color:#2563eb;
    color:#2563eb;
  }

  /* ëª¨ë°”ì¼ ë¼ë²¨: ê¸°ë³¸ í…ìŠ¤íŠ¸, ë‹¤í¬ëŠ” ì•„ì´ì½˜ë§Œ, ë¬¸ì˜ëŠ” í…ìŠ¤íŠ¸ */
  .btn-label-long{display:inline;}
  .btn-label-short{display:none;}

  .dark-btn{width:auto;}
  .dark-btn .btn-label-long{display:none;}
  .dark-btn .btn-label-short{
    display:inline;
    font-size:18px;
    line-height:1;
  }

  .contact-btn .btn-label-long{display:none;}
  .contact-btn .btn-label-short{display:inline;}

  /* âœ… ëª¨ë°”ì¼: ì¹´ë“œ ì¡°íšŒìˆ˜ ìˆ¨ê¹€ + ìƒì„¸ ë²„íŠ¼ ìˆ¨ê¹€(B) */
  .views-mini{display:none;}
  .detail-btn{display:none;}

  .search-link{
    font-size:12px;
    margin-top:2px;
  }
}
</style>
</head>

<body>

<header class="topbar">
  <div class="topbar-inner">
    <a class="brand" href="/">
      <div class="logo" aria-hidden="true">
        <svg viewBox="0 0 24 24" fill="none">
          <path d="M12 21s7-4.6 7-11a7 7 0 0 0-14 0c0 6.4 7 11 7 11z"
                stroke="currentColor" stroke-width="2.2" stroke-linejoin="round"/>
          <path d="M12 11.5a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"
                stroke="currentColor" stroke-width="2.2"/>
        </svg>
      </div>
      <div class="brand-text">ë™ë„¤ë§›ì§‘</div>
    </a>

    <div class="top-actions">
      <!-- ë¬¸ì˜(í…ìŠ¤íŠ¸) -->
      <button class="contact-btn" id="contactBtn" title="ê°€ê²Œ ì œë³´/í™ë³´ ë¬¸ì˜" type="button">
        <span class="btn-label-long">ë¬¸ì˜</span>
        <span class="btn-label-short">ë¬¸ì˜í•˜ê¸°</span>
      </button>

      <!-- ë‹‰ë„¤ì„(í…ìŠ¤íŠ¸) -->
      <button class="nick-btn" id="nickBtn" type="button">
        <span class="btn-label-long" id="nickLabelLong">ë‹‰ë„¤ì„</span>
        <span class="btn-label-short" id="nickLabelShort">ğŸ™‚ ë‹‰</span>
      </button>

      <!-- ê³µìœ (ì•„ì´ì½˜) -->
      <button class="share-btn" id="shareBtn" title="ê³µìœ " type="button" aria-label="ê³µìœ ">
        <span class="btn-label-long">ê³µìœ </span>
        <span class="btn-label-short">ğŸ”—</span>
      </button>

      <!-- ë‹¤í¬(ì•„ì´ì½˜) -->
      <button class="dark-btn" id="darkBtn" title="ë‹¤í¬ëª¨ë“œ" type="button" aria-label="ë‹¤í¬ëª¨ë“œ">
        <span class="btn-label-long">ë‹¤í¬</span>
        <span class="btn-label-short">ğŸŒ™</span>
      </button>
    </div>
  </div>
</header>

<main class="container">
<section>
  <div class="page-hero">
    <!-- âœ… id ì¶”ê°€ -->
    <h1 class="page-title" id="pageTitle">ë©´ëª©ë™ ë§›ì§‘</h1>
    <div class="subtitle">
      ë©´ëª©ë™ ì£¼ë¯¼ì´ ì§ì ‘ ê³ ë¥¸ ë™ë„¤ ë§›ì§‘ Â· ê´‘ê³ ëŠ” <b>â€œê´‘ê³ â€</b>ë¡œ í‘œì‹œí•©ë‹ˆë‹¤<br>
      <span style="font-size:12px;">âœ… ìˆ˜ì‹œ ì—…ë°ì´íŠ¸ Â· âœ… ì œë³´ í™˜ì˜(ìƒë‹¨ â€˜ë¬¸ì˜â€™)</span>
    </div>

    <div class="controls">
      <!-- âœ… ë’¤ë¡œ ë²„íŠ¼(ì¹´í…Œê³ ë¦¬ í™”ë©´ìœ¼ë¡œ) -->
      <a class="pill" id="backBtn" href="/" style="display:none;">â† ì¹´í…Œê³ ë¦¬</a>

      <div class="search">
        <input id="searchInput" placeholder="êµ­ë°¥, ì´ˆë°¥, ìˆ ì§‘Â·í¬ì°¨â€¦" />
        <a class="search-link" href="https://blog.naver.com/dongnepage" target="_blank" rel="noopener noreferrer">
          ë™ë„¤í˜ì´ì§€ ë¸”ë¡œê·¸ ë°”ë¡œê°€ê¸°
        </a>
      </div>

      <div class="sort">
        <select id="sortSelect" title="ì •ë ¬">
          <option value="new">ê¸°ë³¸ìˆœ</option>
          <option value="popular">ë‚´ ê¸°ê¸° ì¸ê¸°ìˆœ</option>
        </select>
      </div>

      <div class="pill-row">
        <button class="pill active" data-filter="all" type="button">ì „ì²´</button>
      </div>
    </div>

    <div class="banner" id="topBanner">
      <img class="banner-image" src="https://i.imgur.com/d9CndUv.png" alt="ë°°ë„ˆ ì´ë¯¸ì§€">
      <div class="banner-inner">
        <div class="banner-left">
          <div class="banner-badge" id="bannerBadge" aria-hidden="true"></div>
          <div class="banner-text">
            <div class="banner-tag">
              ë™ë„¤ ê°€ê²Œ ì¶”ì²œ <span class="ad-chip" id="bannerAdChip">ê´‘ê³ </span>
            </div>
            <div class="banner-title" id="bannerTitle">ë°°ë„ˆ ìë¦¬ (í™ë³´ ë“¤ì–´ì˜¤ë©´ ì—¬ê¸°!)</div>
            <div class="banner-sub" id="bannerSub">ê°€ê²Œëª… Â· í•œ ì¤„ ì†Œê°œ Â· ì´ë²¤íŠ¸</div>
          </div>
        </div>

        <!-- âœ… ë°°ë„ˆ: CTA í•˜ë‚˜ë§Œ(ë¬¸ì˜) -->
        <div class="banner-actions">
          <button class="banner-mini" id="bannerAskBtn" title="ë¬¸ì˜" type="button">ë¬¸ì˜</button>
        </div>
      </div>
    </div>
  </div>

  <div id="detailView" class="detail-view" aria-live="polite"></div>
  <div id="cardsGrid" class="grid"></div>
</section>

<aside>
  <div class="side-card">
    <div class="side-title">
      <span>â¤ï¸ ë‚´ê°€ ì°œí•œ ë§›ì§‘</span>
      <span class="count" id="savedCount">0ê°œ</span>
    </div>

    <div id="savedList" class="side-list">ì•„ì§ ì—†ìŒ</div>

    <div class="side-actions">
      <button class="small-btn primary" id="aboutBtn" type="button">ì†Œê°œ</button>
      <button class="small-btn" id="clearSavedBtn" type="button">ì „ì²´ ë¹„ìš°ê¸°</button>
    </div>

    <div class="side-mini-link">
      ê°€ê²Œ ì œë³´/ê´‘ê³  ë¬¸ì˜ëŠ”
      <button id="sideContactBtn" type="button">ì—¬ê¸°</button>
    </div>
  </div>
</aside>
</main>

<footer class="footer">
  <div class="left">
    <span class="pill">ìš´ì˜: ë™ë„¤ë§›ì§‘</span>
    <span class="pill">ë¬¸ì˜: ì˜¤í”ˆì±„íŒ…</span>
    <span>ë©´ëª©ë™ Â· ì‚¬ê°€ì • Â· ì¤‘ë‘êµ¬ ë§›ì§‘ ì •ë³´ ëª¨ìŒ</span>
    <span>â€» ë‹‰ë„¤ì„/ì°œ/ì¡°íšŒìˆ˜ëŠ” ì´ ê¸°ê¸°(ë¸Œë¼ìš°ì €)ì—ë§Œ ì €ì¥ë©ë‹ˆë‹¤.</span>
    <span>â€» ê°œì¸ì ì¸ ë°©ë¬¸ ê²½í—˜ì„ ë°”íƒ•ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.</span>
  </div>
  <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap;">
    <button id="footerPolicyBtn" type="button">ê°œì¸ì •ë³´ ì•ˆë‚´</button>
    <button id="footerAdBtn" type="button">ê´‘ê³  í‘œê¸°</button>
    <button id="footerShareBtn" type="button">ë§í¬ ë³µì‚¬</button>
  </div>
</footer>

<!-- ë‹‰ë„¤ì„ -->
<div id="nickModal" class="modal hidden">
  <div class="modal-box">
    <h3>ë‹‰ë„¤ì„ ì„¤ì •</h3>
    <input id="nickInput" placeholder="ë‹‰ë„¤ì„ ì…ë ¥">
    <button id="saveNick" type="button">ì €ì¥</button>
    <div class="modal-row">
      <button class="btn-ghost" id="closeNick" type="button">ë‹«ê¸°</button>
    </div>
  </div>
</div>

<!-- ì†Œê°œ -->
<div id="aboutModal" class="modal hidden">
  <div class="modal-box">
    <h3>ì†Œê°œ</h3>
    <div class="form-note">
      â€¢ ë™ë„¤ì—ì„œ ìì£¼ ì°¾ëŠ” ë§›ì§‘ì„ ëª¨ì•„ë‘ëŠ” í˜ì´ì§€ì˜ˆìš”.<br>
      â€¢ íšŒì›ê°€ì… ì—†ì´ ì‚¬ìš© ê°€ëŠ¥í•´ìš”.<br>
      â€¢ ë‹‰ë„¤ì„/ì°œ/ì¡°íšŒìˆ˜ëŠ” <b>ì´ ê¸°ê¸°(ë¸Œë¼ìš°ì €)</b>ì—ë§Œ ì €ì¥ë¼ìš”.<br>
      â€¢ ë“±ë¡/ì œë³´/í™ë³´ëŠ” â€œê°€ê²Œëª…/ì£¼ì†Œ/ëŒ€í‘œë©”ë‰´/ì‚¬ì§„(ìˆìœ¼ë©´)â€ ë³´ë‚´ì£¼ë©´ ë¼ìš”.
    </div>
    <div class="modal-row">
      <button class="btn-ghost" id="closeAbout" type="button">ë‹«ê¸°</button>
    </div>
  </div>
</div>

<!-- ê³µìœ  -->
<div id="shareModal" class="modal hidden">
  <div class="modal-box">
    <h3>ê³µìœ </h3>
    <div class="form-note">
      ì•„ë˜ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ <b>í˜„ì¬ í˜ì´ì§€ ì£¼ì†Œ</b>ê°€ ë³µì‚¬ë¼ìš”.
    </div>
    <button id="copyLinkBtn" type="button">ë§í¬ ë³µì‚¬</button>
    <div class="modal-row">
      <button class="btn-ghost" id="closeShare" type="button">ë‹«ê¸°</button>
    </div>
  </div>
</div>

<!-- ë¬¸ì˜ -->
<div id="contactModal" class="modal hidden">
  <div class="modal-box">
    <h3>ê°€ê²Œ ì œë³´ / í™ë³´ ë¬¸ì˜</h3>
    <div class="form-note">
      ğŸ“ ë©´ëª©ë™/ì‚¬ê°€ì • ì£¼ë³€ ê°€ê²Œë§Œ ë°›ì•„ìš”.<br><br>
      ğŸ’¬ ì˜¤í”ˆì±„íŒ…ìœ¼ë¡œ ë¬¸ì˜í•´ì£¼ì„¸ìš”.<br><br>
      ë³´ë‚´ì‹¤ ê²ƒ:<br>
      â€¢ ê°€ê²Œëª… / ì£¼ì†Œ / ëŒ€í‘œë©”ë‰´ / ì‚¬ì§„(ìˆìœ¼ë©´)<br>
      â€¢ ì›í•˜ì‹œëŠ” ê¸°ê°„(7ì¼/30ì¼)
    </div>
    <button id="openKakaoBtn" type="button">ì¹´ì¹´ì˜¤ ì˜¤í”ˆì±„íŒ… ì—´ê¸°</button>
    <div class="modal-row">
      <button class="btn-ghost" id="closeContact" type="button">ë‹«ê¸°</button>
    </div>
  </div>
</div>

<!-- ê°œì¸ì •ë³´ ì•ˆë‚´ -->
<div id="policyModal" class="modal hidden">
  <div class="modal-box">
    <h3>ê°œì¸ì •ë³´ ì•ˆë‚´</h3>
    <div class="form-note">
      â€¢ ì´ í˜ì´ì§€ëŠ” íšŒì›ê°€ì… ì—†ì´ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ìš”.<br>
      â€¢ ë‹‰ë„¤ì„/ì°œ/ì¡°íšŒìˆ˜ëŠ” ì„œë²„ë¡œ ì „ì†¡ë˜ì§€ ì•Šê³ , <b>ì´ ê¸°ê¸°(ë¸Œë¼ìš°ì €)</b>ì—ë§Œ ì €ì¥ë¼ìš”.<br>
      â€¢ ë¬¸ì˜ëŠ” ì™¸ë¶€ ì˜¤í”ˆì±„íŒ…ìœ¼ë¡œ ì—°ê²°ë¼ìš”(í•´ë‹¹ ì„œë¹„ìŠ¤ì˜ ì •ì±…ì„ ë”°ë¦…ë‹ˆë‹¤).
    </div>
    <div class="modal-row">
      <button class="btn-ghost" id="closePolicy" type="button">ë‹«ê¸°</button>
    </div>
  </div>
</div>

<!-- ê´‘ê³  í‘œê¸° -->
<div id="adModal" class="modal hidden">
  <div class="modal-box">
    <h3>ê´‘ê³  í‘œê¸°</h3>
    <div class="form-note">
      â€¢ ê´‘ê³ /ìŠ¤í°ì„œë¡œ ë“±ë¡ëœ ê°€ê²ŒëŠ” ì¹´ë“œ ë˜ëŠ” ë°°ë„ˆì— <b>â€œê´‘ê³ â€</b> í‘œê¸°ê°€ í‘œì‹œë©ë‹ˆë‹¤.<br>
      â€¢ ì¼ë°˜ ì¶”ì²œê³¼ ê´‘ê³ ëŠ” í‘œê¸°ë¡œ êµ¬ë¶„í•©ë‹ˆë‹¤.
    </div>
    <div class="modal-row">
      <button class="btn-ghost" id="closeAd" type="button">ë‹«ê¸°</button>
    </div>
  </div>
</div>

<div id="toast" class="toast">ì €ì¥ë¨</div>

<script src="shared/category-store.js"></script>
<script>
/* ë¬¸ì˜ ë§í¬ */
const CONTACT_KAKAO = "https://open.kakao.com/o/gRmo49di";

/* ë¡œì»¬ ì €ì¥í‚¤(ê°œì¸ ê¸°ëŠ¥ë§Œ) */
const LS_SAVED  = "saved_v2";
const LS_NICK   = "nick";
const LS_DARK   = "dark_v1";
const LS_VIEWS  = "views_v1";
const LS_CATEGORY = CategoryStore.KEY;

function buildCategories(){
  return CategoryStore.loadCategories().map(cat => ({
    id:`cat-${cat}`,
    name:cat,
    cat,
    catKey:cat,
    desc:CategoryStore.categoryDescription(cat),
    thumbnail:CategoryStore.categoryImageMap[cat] || "",
    addr:"",
    isCategory:true
  }));
}

let CATEGORIES = buildCategories();

/* âœ… ì‹¤ì œ ì‹ë‹¹ ë°ì´í„°(ì—¬ê¸°ì— ê³„ì† ì¶”ê°€í•˜ë©´ ë¨) */
const DEFAULT_PLACES = [
  /* ì˜ˆì‹œ(ì›í•˜ë©´ ì‚­ì œ ê°€ëŠ¥)
  {id:"p-1", name:"ì‚¬ê°€ì • êµ­ë°¥", cat:"í•œì‹", desc:"ì§„í•œ ì‚¬ê³¨êµ­ë°¥", thumbnail:"", images:[], addr:"ì‚¬ê°€ì •ë¡œ 00", sponsor:false, sponsorUntil:""},
  {id:"p-2", name:"ë©´ëª© ìŠ¤ì‹œ", cat:"ì¼ì‹", desc:"ê°€ì„±ë¹„ ì´ˆë°¥", thumbnail:"", images:[], addr:"ë©´ëª©ë¡œ 00", sponsor:false, sponsorUntil:""},
  */
];

/* âœ… í™”ë©´ ëª¨ë“œ: cats(ì¹´í…Œê³ ë¦¬6ê°œ) / list(ì‹ë‹¹ëª©ë¡) */
let viewMode = "cats";     // ì‹œì‘ì€ ì¹´í…Œê³ ë¦¬ í™”ë©´
let selectedCat = "all";

let filter="all", q="";
let sortMode="new";

/* ì‹¤ì œ ì‹ë‹¹ ëª©ë¡ */
const migratedPlaces = JSON.parse(localStorage.getItem("RESTAURANT_LIST") || "null");
let places = JSON.parse(localStorage.getItem("PLACES_DATA") || "null") || migratedPlaces || [...DEFAULT_PLACES];
if(migratedPlaces && !localStorage.getItem("PLACES_DATA")){
  localStorage.setItem("PLACES_DATA", JSON.stringify(migratedPlaces));
}
function unique(list){
  return Array.from(new Set(list.filter(Boolean)));
}

function getPlaceImages(place){
  const fromImagesArray = Array.isArray(place?.images) ? place.images : [];
  return unique(fromImagesArray.map(v=>String(v||"").trim())).slice(0,4);
}

function isAutoGeneratedEtcPlace(place){
  const cat = CategoryStore.normalizeCategory(place?.cat);
  if(cat !== "ê¸°íƒ€") return false;
  const id = String(place?.id || "").toLowerCase();
  const name = String(place?.name || "").trim();
  const autoFlag = place?.autoCreated || place?.autoGenerated || place?.isDefault;
  const defaultId = id.startsWith("d-") || id.startsWith("default-");
  const genericName = !name || /^ê¸°íƒ€(?:\s*ë§›ì§‘)?$/i.test(name) || /ë©´ëª©ë™\s*ê¸°íƒ€/.test(name);
  return !!(autoFlag || defaultId || genericName);
}

places = places.map(p=>{
  const images = getPlaceImages(p);
  const thumbnail = String(p?.thumbnail || "").trim() || images[0] || "";
  return { ...p, cat: CategoryStore.normalizeCategory(p.cat), thumbnail, images };
}).filter(p=>!isAutoGeneratedEtcPlace(p));
localStorage.setItem("PLACES_DATA", JSON.stringify(places));

let savedIds = loadSavedIds();
let views = loadViews();

/* ====== DOM ====== */
const grid=document.getElementById("cardsGrid");
const savedList=document.getElementById("savedList");
const savedCount=document.getElementById("savedCount");

/* íƒ€ì´í‹€/ë’¤ë¡œ */
const pageTitleEl = document.getElementById("pageTitle");
const backBtn = document.getElementById("backBtn");
const pillRowEl = document.querySelector(".pill-row");
const sortWrapEl = document.querySelector(".sort");

function renderPills(){
  if(!pillRowEl) return;
  const categoryPills = CATEGORIES.map(c=>`<button class="pill" data-filter="${esc(c.catKey)}" type="button">${esc(CategoryStore.displayCategory(c.name))}</button>`).join("");
  pillRowEl.innerHTML = `<button class="pill active" data-filter="all" type="button">ì „ì²´</button>${categoryPills}`;
}

function syncCategoriesFromStorage(){
  CATEGORIES = buildCategories();
  renderPills();
}

syncCategoriesFromStorage();

/* í† ìŠ¤íŠ¸ */
const toast = document.getElementById("toast");
let toastTimer=null;
function showToast(msg){
  toast.textContent=msg;
  toast.classList.add("show");
  clearTimeout(toastTimer);
  toastTimer=setTimeout(()=>toast.classList.remove("show"),1200);
}

/* ìœ í‹¸ */
function esc(s){ return String(s||"").replace(/[&<>"]/g, m=>({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;" }[m])); }

/* ====== ë¡œì»¬ ì €ì¥ ====== */
function loadSavedIds(){
  const v2=localStorage.getItem(LS_SAVED);
  if(v2){
    try{ const arr=JSON.parse(v2); if(Array.isArray(arr)) return arr; }catch(e){}
  }
  localStorage.setItem(LS_SAVED, JSON.stringify([]));
  return [];
}
function saveSavedIds(){ localStorage.setItem(LS_SAVED, JSON.stringify(savedIds)); }

function loadViews(){
  const raw = localStorage.getItem(LS_VIEWS);
  if(!raw){
    localStorage.setItem(LS_VIEWS, JSON.stringify({}));
    return {};
  }
  try{
    const obj = JSON.parse(raw);
    if(obj && typeof obj === "object") return obj;
  }catch(e){}
  localStorage.setItem(LS_VIEWS, JSON.stringify({}));
  return {};
}
function saveViews(){ localStorage.setItem(LS_VIEWS, JSON.stringify(views)); }
function incView(id){
  views[id] = (views[id]||0) + 1;
  saveViews();
}

/* ====== ë‹¤í¬ëª¨ë“œ ====== */
const darkBtn = document.getElementById("darkBtn");
function applyDarkFromStorage(){
  const v = localStorage.getItem(LS_DARK);
  if(v === "1") document.body.classList.add("dark");
}
function setDarkSave(){
  localStorage.setItem(LS_DARK, document.body.classList.contains("dark") ? "1" : "0");
}
function toggleDark(){
  document.body.classList.toggle("dark");
  setDarkSave();
  rerenderAll();
}
darkBtn.onclick = toggleDark;
applyDarkFromStorage();

/* ====== (í•µì‹¬) ëª¨ë“œ ì „í™˜ ====== */
function setPillActive(name){
  document.querySelectorAll(".pill").forEach(x=>{
    const f = x.dataset && x.dataset.filter;
    if(!f) return;
    x.classList.toggle("active", f===name);
  });
}
function updateModeUI(){
  const isCats = (viewMode==="cats");
  backBtn.style.display = isCats ? "none" : "inline-flex";
  if(pillRowEl) pillRowEl.style.display = isCats ? "none" : "flex";
  if(sortWrapEl) sortWrapEl.style.display = isCats ? "none" : "block";
  if(!isCats){
    backBtn.setAttribute("href", buildCategoryUrl(selectedCat || "all"));
  }
}

function buildCategoryUrl(cat){
  if(!cat || cat === "all") return location.pathname;
  return location.pathname + "?cat=" + encodeURIComponent(cat);
}
function buildPlaceUrl(place){
  const params = new URLSearchParams();
  if(place?.cat) params.set("cat", place.cat);
  params.set("place", place.id);
  return location.pathname + "?" + params.toString();
}

function applyRoute(){
  const params = new URLSearchParams(location.search);
  const catParam = params.get("cat");
  const placeParam = params.get("place");

  activePlaceId = placeParam || null;
  if(activePlaceId && activePlaceId !== lastViewedPlaceId){
    incView(activePlaceId);
    lastViewedPlaceId = activePlaceId;
  }

  if(catParam){
    viewMode = "list";
    selectedCat = catParam;
    filter = catParam;
    pageTitleEl.textContent = catParam + " ë§›ì§‘";
    setPillActive(catParam);
  }else if(placeParam){
    const place = places.find(p=>p.id===placeParam);
    const cat = place?.cat || "all";
    viewMode = "list";
    selectedCat = cat;
    filter = cat;
    pageTitleEl.textContent = cat === "all" ? "ì „ì²´ ë§›ì§‘" : (CategoryStore.displayCategory(cat) + " ë§›ì§‘");
    setPillActive(cat);
  }else{
    viewMode = "cats";
    selectedCat = "all";
    filter = "all";
    pageTitleEl.textContent = "ë©´ëª©ë™ ë§›ì§‘";
    setPillActive("all");
  }

  updateModeUI();
  renderDetail();
  render();
}

/* ====== SVG ì¼ëŸ¬ìŠ¤íŠ¸(ì‚¬ì§„ ì—†ì„ ë•Œ) ====== */
const PALETTES = [
  {a:"#2563eb", b:"#22c55e", bg:"#eef2ff"},
  {a:"#ef4444", b:"#f59e0b", bg:"#fff7ed"},
  {a:"#8b5cf6", b:"#06b6d4", bg:"#f5f3ff"},
  {a:"#10b981", b:"#2563eb", bg:"#ecfeff"},
  {a:"#f97316", b:"#22c55e", bg:"#fefce8"},
  {a:"#0ea5e9", b:"#a855f7", bg:"#eff6ff"},
];
function hashString(str){
  let h=2166136261;
  for(let i=0;i<str.length;i++){
    h ^= str.charCodeAt(i);
    h = Math.imul(h, 16777619);
  }
  return (h>>>0);
}
function pickPalette(seed){
  const idx = seed % PALETTES.length;
  return PALETTES[idx];
}
function catIconSVG(cat, stroke){
  const c = cat || "default";
  const s = stroke || "#0f172a";
  const common = `fill="none" stroke="${s}" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"`;
  if(c==="ì¹´í˜"){
    return `<svg viewBox="0 0 24 24">
      <path ${common} d="M7 8h10v6a5 5 0 0 1-5 5H10a3 3 0 0 1-3-3V8z"/>
      <path ${common} d="M17 9h2a2 2 0 0 1 0 4h-2"/>
      <path ${common} d="M8 3c0 2 2 2 2 4M12 3c0 2 2 2 2 4M16 3c0 2 2 2 2 4"/>
    </svg>`;
  }
  if(c==="ìˆ ì§‘" || c==="ìˆ ì§‘Â·í¬ì°¨" || c==="Bar / Pocha (ìˆ ì§‘)"){
    return `<svg viewBox="0 0 24 24">
      <path ${common} d="M7 3h10l-1 8a4 4 0 0 1-4 3H12a4 4 0 0 1-4-3L7 3z"/>
      <path ${common} d="M9 21h6"/>
      <path ${common} d="M12 14v7"/>
      <path ${common} d="M8 7h8"/>
    </svg>`;
  }
  if(c==="ê³ ê¸°"){
    return `<svg viewBox="0 0 24 24">
      <path ${common} d="M6 12c0-4 3-7 7-7 3 0 5 2 5 5 0 4-3 9-9 9-2 0-3-1-3-2 0-2 1-3 3-5z"/>
      <path ${common} d="M14 9c.8 0 1.5.7 1.5 1.5S14.8 12 14 12s-1.5-.7-1.5-1.5S13.2 9 14 9z"/>
    </svg>`;
  }
  if(c==="ì¼ì‹"){
    return `<svg viewBox="0 0 24 24">
      <path ${common} d="M7 14c2-2 8-2 10 0s-2 7-5 7-7-5-5-7z"/>
      <path ${common} d="M9 13c0-3 6-3 6 0"/>
      <path ${common} d="M5 9h14"/>
    </svg>`;
  }
  if(c==="ì¤‘ì‹"){
    return `<svg viewBox="0 0 24 24">
      <path ${common} d="M6 9h12l-1 9H7L6 9z"/>
      <path ${common} d="M9 9c0-2 1-3 3-3s3 1 3 3"/>
      <path ${common} d="M8 18h8"/>
    </svg>`;
  }
  return `<svg viewBox="0 0 24 24">
    <path ${common} d="M6 10c0-2 2-4 6-4s6 2 6 4v4c0 4-3 7-6 7s-6-3-6-7v-4z"/>
    <path ${common} d="M8 10h8"/>
    <path ${common} d="M9 3c0 2 2 2 2 4M13 3c0 2 2 2 2 4"/>
  </svg>`;
}
function cardIllustrationSVG(place){
  const name = place?.name || "place";
  const cat  = place?.cat || "í•œì‹";
  const seed = hashString(name + "|" + cat);
  const pal  = pickPalette(seed);
  const a = pal.a, b = pal.b, bg = pal.bg;
  const iconStroke = (document.body.classList.contains("dark") ? "#e2e8f0" : "#0f172a");
  const icon = catIconSVG(cat, iconStroke);

  const t1 = esc(name);
  const t2 = esc(place?.desc || "");
  return `
  <svg viewBox="0 0 800 500" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="${t1}">
    <defs>
      <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
        <stop offset="0" stop-color="${a}" stop-opacity=".18"/>
        <stop offset="1" stop-color="${b}" stop-opacity=".18"/>
      </linearGradient>
      <radialGradient id="r" cx="30%" cy="20%" r="70%">
        <stop offset="0" stop-color="${a}" stop-opacity=".22"/>
        <stop offset="1" stop-color="${bg}" stop-opacity="1"/>
      </radialGradient>
      <filter id="s" x="-20%" y="-20%" width="140%" height="140%">
        <feDropShadow dx="0" dy="14" stdDeviation="18" flood-color="rgba(15,23,42,.18)"/>
      </filter>
    </defs>
    <rect width="800" height="500" fill="url(#r)"/>
    <rect width="800" height="500" fill="url(#g)"/>
    <circle cx="90" cy="420" r="140" fill="${a}" opacity=".08"/>
    <circle cx="720" cy="120" r="160" fill="${b}" opacity=".08"/>
    <path d="M0 360 C140 320, 260 420, 400 380 C540 340, 650 260, 800 300 L800 500 L0 500 Z"
      fill="${b}" opacity=".10"/>
    <g filter="url(#s)">
      <rect x="250" y="120" width="300" height="220" rx="32" fill="rgba(255,255,255,.65)"/>
    </g>
    <g transform="translate(340,165) scale(5)">${icon}</g>
    <text x="400" y="390" text-anchor="middle" font-size="26" font-weight="900"
      fill="${document.body.classList.contains("dark") ? "rgba(248,250,252,.92)" : "rgba(15,23,42,.85)"}">${t1}</text>
    <text x="400" y="420" text-anchor="middle" font-size="16" font-weight="800"
      fill="${document.body.classList.contains("dark") ? "rgba(148,163,184,.95)" : "rgba(100,116,139,.95)"}">${t2}</text>
  </svg>`;
}
function bannerBadgeSVG(){
  const stroke = (document.body.classList.contains("dark") ? "#e2e8f0" : "#0f172a");
  return `
    <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
      <path d="M7 13c2.2-1.6 3.8-1.6 6 0s3.8 1.6 6 0" stroke="${stroke}" stroke-width="2.2" stroke-linecap="round"/>
      <path d="M6 9.5c2.4-1.8 4.2-1.8 6.6 0 2.4 1.8 4.2 1.8 6.6 0" stroke="${stroke}" stroke-width="2.2" stroke-linecap="round" opacity=".85"/>
      <path d="M8 17h8" stroke="${stroke}" stroke-width="2.2" stroke-linecap="round" opacity=".9"/>
    </svg>`;
}

/* ====== ë°°ë„ˆ ë Œë” ====== */
const bannerTitleEl = document.getElementById("bannerTitle");
const bannerSubEl = document.getElementById("bannerSub");
const bannerBadge = document.getElementById("bannerBadge");
const bannerAdChip = document.getElementById("bannerAdChip");
const bannerAskBtn = document.getElementById("bannerAskBtn");

/* ë°°ë„ˆ(1ë‹¨ê³„ ê³ ì •) */
let banner = {title:"ë°°ë„ˆ ìë¦¬ (í™ë³´ ë“¤ì–´ì˜¤ë©´ ì—¬ê¸°!)", sub:"ê°€ê²Œëª… Â· í•œ ì¤„ ì†Œê°œ Â· ì´ë²¤íŠ¸", link:"", isAd:true};

function renderBanner(){
  bannerTitleEl.textContent = banner.title;
  bannerSubEl.textContent = banner.sub;
  bannerBadge.innerHTML = bannerBadgeSVG();
  bannerAdChip.style.display = banner.isAd ? "inline-block" : "none";
}
renderBanner();
bannerAskBtn.onclick = ()=> openContact();

/* ====== ìŠ¤í°ì„œ(ê´‘ê³ ) ====== */
function isSponsorActive(p){
  if(!p || !p.sponsor) return false;
  const until = (p.sponsorUntil||"").trim();
  if(!until) return true;
  const today = new Date();
  const end = new Date(until + "T23:59:59");
  return end.getTime() >= today.getTime();
}

/* ====== ìƒì„¸ ë·° ====== */
const detailViewEl = document.getElementById("detailView");
let activePlaceId = null;
let lastViewedPlaceId = null;

function buildMapUrl(place){
  const query=(place.addr && place.addr.trim()) ? (place.name+" "+place.addr) : place.name;
  return "https://map.naver.com/v5/search/" + encodeURIComponent(query);
}

function renderDetail(){
  if(!activePlaceId){
    detailViewEl.classList.remove("show");
    detailViewEl.innerHTML = "";
    return;
  }

  const place = places.find(p=>p.id===activePlaceId);
  if(!place){
    detailViewEl.classList.remove("show");
    detailViewEl.innerHTML = "";
    return;
  }

  const v = views[place.id] || 0;
  const sponsorText = isSponsorActive(place) ? " Â· ê´‘ê³ " : "";
  const meta = `ì¹´í…Œê³ ë¦¬: <b>${esc(CategoryStore.displayCategory(place.cat||""))}</b>${sponsorText} Â· ì¡°íšŒìˆ˜(ë‚´ ê¸°ê¸°): <b>${v}</b>`;
  const desc = place.desc ? ("ì†Œê°œ: " + esc(place.desc)) : "ì†Œê°œ: (ì—†ìŒ)";
  const addr = (place.addr && place.addr.trim()) ? ("ì£¼ì†Œ: " + esc(place.addr)) : "ì£¼ì†Œ: (ì—†ìŒ)";
  const mapUrl = buildMapUrl(place);
  const images = getPlaceImages(place);
  const galleryHtml = images.length
    ? `<div class="detail-gallery" aria-label="ê°€ê²Œ ì‚¬ì§„ ê°¤ëŸ¬ë¦¬">${images.map((src,idx)=>`<div class="detail-slide"><img src="${esc(src)}" alt="${esc(place.name||"ê°€ê²Œ")} ì‚¬ì§„ ${idx+1}"></div>`).join("")}</div>`
    : "";

  detailViewEl.innerHTML = `
    <div class="page-title" style="font-size:20px;-webkit-text-fill-color:unset;background:none;">${esc(place.name || "ë§›ì§‘ ìƒì„¸")}</div>
    <div class="detail-meta">${meta}</div>
    ${galleryHtml}
    <div class="detail-desc">${desc}</div>
    <div class="detail-meta" style="margin-top:8px;">${addr}</div>
    <div class="detail-actions">
      <a href="${mapUrl}" target="_blank" rel="noopener noreferrer">ë„¤ì´ë²„ì§€ë„ ì—´ê¸°</a>
      <button id="detailCopyAddr" type="button">ì£¼ì†Œ ë³µì‚¬</button>
    </div>
  `;
  detailViewEl.classList.add("show");

  const copyBtn = document.getElementById("detailCopyAddr");
  if(copyBtn){
    copyBtn.onclick = ()=>{
      const addrValue = (place.addr||"").trim();
      if(!addrValue) return showToast("ì£¼ì†Œê°€ ì—†ì–´ìš”");
      navigator.clipboard?.writeText(addrValue).then(()=>showToast("ì£¼ì†Œ ë³µì‚¬ë¨")).catch(()=>window.prompt("ë³µì‚¬í•´ì„œ ì“°ì„¸ìš”", addrValue));
    };
  }
}

/* ====== ë Œë”ìš© ë¦¬ìŠ¤íŠ¸ ë§Œë“¤ê¸° ====== */
function buildList(){
  /* 1) ì¹´í…Œê³ ë¦¬ í™”ë©´: ê³ ì • 6ê°œ */
  if(viewMode==="cats"){
    let list = CATEGORIES.slice();
    if(q){
      list = list.filter(c=>{
        const text = (c.name+" "+(c.desc||"")).toLowerCase();
        return text.includes(q);
      });
    }
    return list;
  }

  /* 2) ì‹ë‹¹ ëª©ë¡ í™”ë©´ */
  let list = places.filter(p=>{
    const text=(p.name+" "+(p.desc||"")+" "+(p.cat||"")+" "+(p.addr||"")).toLowerCase();
    return (filter==="all" || p.cat===filter) && (!q || text.includes(q));
  });

  if(sortMode==="popular"){
    list = list.slice().sort((a,b)=> (views[b.id]||0) - (views[a.id]||0));
  }else{
    list = list.slice();
  }
  return list;
}
function getCardThumbnail(place){
  const thumbnail = String(place?.thumbnail || "").trim();
  if(thumbnail) return thumbnail;
  return getPlaceImages(place)[0] || "";
}
function shouldShowPhoto(place){
  const img = getCardThumbnail(place);
  return !!img;
}

function render(){
  grid.innerHTML="";
  const list = buildList();

  list.forEach(p=>{
    const isCategory = !!p.isCategory;
    const isSaved = (!isCategory && savedIds.includes(p.id));
    const sponsorActive = (!isCategory && isSponsorActive(p));

    const card=document.createElement("a");
    card.className="card card-link" + (sponsorActive ? " has-ad" : "");
    card.id="card-"+p.id;

    const svg = cardIllustrationSVG(p);
    const v = views[p.id]||0;

    const resolvedThumbnail = getCardThumbnail(p);
    const hasPhoto = shouldShowPhoto(p);

    /* âœ… ì¹´í…Œê³ ë¦¬ ì¹´ë“œ / ì‹ë‹¹ ì¹´ë“œ UI ë¶„ë¦¬ */
    if(isCategory){
      card.href = buildCategoryUrl(p.catKey);
      card.innerHTML=`
        <div class="thumb">
          <img src="${hasPhoto ? esc(resolvedThumbnail) : ""}" alt="${esc(p.name)}" style="display:${hasPhoto ? "block" : "none"};" onerror="this.style.display='none'; this.parentElement.querySelector('.thumb-illus').style.display='block';">
          <div class="thumb-illus" style="${hasPhoto ? "display:none;" : ""}">${svg}</div>
          <div class="img-overlay"></div>
          <div class="badge">${esc(CategoryStore.displayCategory(p.cat || p.name))}</div>
        </div>
        <div class="content">
          <div class="name" style="padding-right:0;">${esc(p.name)}</div>
          <div class="desc">${esc(p.desc||"")}</div>
        </div>
      `;
    }else{
      card.href = buildPlaceUrl(p);
      card.innerHTML=`
        <div class="thumb">
          <img src="${hasPhoto ? esc(resolvedThumbnail) : ""}" alt="${esc(p.name)}" style="display:${hasPhoto ? "block" : "none"};" onerror="this.style.display='none'; this.parentElement.querySelector('.thumb-illus').style.display='block';">
          <div class="thumb-illus" style="${hasPhoto ? "display:none;" : ""}">${svg}</div>
          <div class="img-overlay"></div>

          <div class="badge">${esc(CategoryStore.displayCategory(p.cat))}</div>
          ${sponsorActive ? `<div class="badge ad">ê´‘ê³ </div>` : ``}
          <button class="heart ${isSaved?"active":""}" title="ì°œ" type="button" aria-label="ì°œ">â¤</button>
        </div>
        <div class="content">
          <div class="name">${esc(p.name)}</div>
          <div class="desc">${esc(p.desc||"")}</div>
          ${p.addr && p.addr.trim() ? `<div class="addr">ğŸ“ ${esc(p.addr)}</div>` : ``}
          <div class="views-mini">ì¡°íšŒìˆ˜(ë‚´ ê¸°ê¸°) ${v}</div>
        </div>
      `;

      const heartEl = card.querySelector(".heart");
      if(heartEl){
        heartEl.onclick=(e)=>{
          e.preventDefault();
          e.stopPropagation();
          if(isSaved){
            savedIds=savedIds.filter(id=>id!==p.id);
            showToast("ì°œ í•´ì œë¨");
          }else{
            savedIds.push(p.id);
            showToast("ì €ì¥ë¨");
          }
          saveSavedIds();
          renderSaved();
          render();
        };
      }
    }

    grid.appendChild(card);
  });

  if(list.length===0){
    const empty=document.createElement("div");
    empty.style.cssText="grid-column:1/-1;padding:18px;border:1px dashed #cbd5e1;border-radius:18px;background:var(--card);color:var(--muted);font-weight:900;text-align:center;";
    empty.textContent="ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ì–´ìš” ğŸ™‚";
    grid.appendChild(empty);
  }
}

/* ====== ì°œ ëª©ë¡ ====== */
function renderSaved(){
  const savedPlaces=savedIds.map(id=>places.find(p=>p.id===id)).filter(Boolean);
  savedCount.textContent = savedPlaces.length + "ê°œ";

  if(savedPlaces.length===0){
    savedList.textContent="ì•„ì§ ì—†ìŒ";
    return;
  }
  savedList.innerHTML=savedPlaces.map(p=>`
    <a class="saved-item" href="${buildPlaceUrl(p)}" data-id="${p.id}">
      <div class="left">
        <div class="t">${esc(p.name)}</div>
        <div class="s">${esc(CategoryStore.displayCategory(p.cat))} Â· ${esc(p.desc||"")}</div>
      </div>
      <div class="right">
        <div class="go">ì—´ê¸°</div>
        <button class="x" data-x="${p.id}" title="ì°œ í•´ì œ" type="button">âœ•</button>
      </div>
    </a>
  `).join("");

  savedList.querySelectorAll("button.x").forEach(btn=>{
    btn.onclick=(e)=>{
      e.preventDefault();
      e.stopPropagation();
      const id = btn.dataset.x;
      savedIds = savedIds.filter(x=>x!==id);
      saveSavedIds();
      renderSaved();
      render();
      showToast("ì°œ í•´ì œë¨");
    };
  });
}

/* ====== ê²€ìƒ‰/í•„í„°/ì •ë ¬ ====== */
const searchInput=document.getElementById("searchInput");
searchInput.oninput=e=>{ q=(e.target.value||"").trim().toLowerCase(); render(); };

document.querySelectorAll(".pill").forEach(btn=>{
  if(!btn.dataset || !btn.dataset.filter) return;
  btn.onclick=()=>{
    const f = btn.dataset.filter;
    setPillActive(f);

    /* ì¹´í…Œê³ ë¦¬ í™”ë©´ì—ì„œëŠ”: pillì„ ëˆ„ë¥´ë©´ ë°”ë¡œ ê·¸ ëª©ë¡ìœ¼ë¡œ ë“¤ì–´ê°€ê²Œ */
    if(viewMode==="cats"){
      if(f==="all"){
        location.href = buildCategoryUrl("all");
      }else{
        location.href = buildCategoryUrl(f);
      }
      return;
    }

    /* ì‹ë‹¹ ëª©ë¡ í™”ë©´ì—ì„œëŠ”: ê¸°ì¡´ í•„í„°ì²˜ëŸ¼ ë™ì‘ */
    filter = f;
    if(f==="all"){
      pageTitleEl.textContent = "ì „ì²´ ë§›ì§‘";
      selectedCat = "all";
    }else{
      pageTitleEl.textContent = f + " ë§›ì§‘";
      selectedCat = f;
    }
    render();
  };
});

const sortSelect = document.getElementById("sortSelect");
sortSelect.onchange = (e)=>{
  sortMode = e.target.value;
  render();
};

/* ë’¤ë¡œ ë²„íŠ¼ì€ ë§í¬ë¡œ ë™ì‘ */

/* ====== ë‹‰ë„¤ì„ ====== */
const nickBtn=document.getElementById("nickBtn");
const nickLabelLong=document.getElementById("nickLabelLong");
const nickLabelShort=document.getElementById("nickLabelShort");

const nickModal=document.getElementById("nickModal");
const nickInput=document.getElementById("nickInput");
const saveNick=document.getElementById("saveNick");
const closeNick=document.getElementById("closeNick");

function setNickLabels(v){
  const name = (v||"").trim();
  if(!name){
    nickLabelLong.textContent = "ë‹‰ë„¤ì„";
    nickLabelShort.textContent = "ğŸ™‚ ë‹‰";
    return;
  }
  nickLabelLong.textContent = name + "ë‹˜";
  const cut = name.length > 4 ? (name.slice(0,4) + "â€¦") : name;
  nickLabelShort.textContent = "ğŸ™‚ " + cut;
}
nickBtn.onclick=()=>nickModal.classList.remove("hidden");
closeNick.onclick=()=>nickModal.classList.add("hidden");
saveNick.onclick=()=>{
  const v=(nickInput.value||"").trim();
  if(!v) return showToast("ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”");
  localStorage.setItem(LS_NICK, v);
  setNickLabels(v);
  nickModal.classList.add("hidden");
  showToast("ë‹‰ë„¤ì„ ì €ì¥ë¨");
};
setNickLabels(localStorage.getItem(LS_NICK));

/* ====== ëª¨ë‹¬ ê³µí†µ ë‹«ê¸° ====== */
function bindModalClose(modalEl, closeFn){
  modalEl.addEventListener("click",(e)=>{ if(e.target===modalEl) closeFn(); });
}
const aboutBtn=document.getElementById("aboutBtn");
const aboutModal=document.getElementById("aboutModal");
const closeAbout=document.getElementById("closeAbout");
aboutBtn.onclick=()=>aboutModal.classList.remove("hidden");
closeAbout.onclick=()=>aboutModal.classList.add("hidden");

bindModalClose(nickModal, ()=>nickModal.classList.add("hidden"));
bindModalClose(aboutModal, ()=>aboutModal.classList.add("hidden"));

/* ê°œì¸ì •ë³´/ê´‘ê³  ëª¨ë‹¬ */
const policyModal = document.getElementById("policyModal");
const adModal = document.getElementById("adModal");
const footerPolicyBtn = document.getElementById("footerPolicyBtn");
const footerAdBtn = document.getElementById("footerAdBtn");
const closePolicy = document.getElementById("closePolicy");
const closeAd = document.getElementById("closeAd");
footerPolicyBtn.onclick = ()=> policyModal.classList.remove("hidden");
footerAdBtn.onclick = ()=> adModal.classList.remove("hidden");
closePolicy.onclick = ()=> policyModal.classList.add("hidden");
closeAd.onclick = ()=> adModal.classList.add("hidden");
bindModalClose(policyModal, ()=>policyModal.classList.add("hidden"));
bindModalClose(adModal, ()=>adModal.classList.add("hidden"));

/* ====== ê³µìœ  ====== */
const shareBtn = document.getElementById("shareBtn");
const shareModal = document.getElementById("shareModal");
const closeShare = document.getElementById("closeShare");
const copyLinkBtn = document.getElementById("copyLinkBtn");
const footerShareBtn = document.getElementById("footerShareBtn");

function copyLink(){
  const url = location.href;
  navigator.clipboard?.writeText(url).then(()=>showToast("ë§í¬ ë³µì‚¬ë¨")).catch(()=>{
    window.prompt("ì•„ë˜ ë§í¬ë¥¼ ë³µì‚¬í•˜ì„¸ìš”", url);
  });
}
shareBtn.onclick = ()=> shareModal.classList.remove("hidden");
closeShare.onclick = ()=> shareModal.classList.add("hidden");
bindModalClose(shareModal, ()=>shareModal.classList.add("hidden"));
copyLinkBtn.onclick = copyLink;
footerShareBtn.onclick = copyLink;

/* ====== ë¬¸ì˜ ====== */
const contactBtn = document.getElementById("contactBtn");
const contactModal = document.getElementById("contactModal");
const closeContact = document.getElementById("closeContact");
const openKakaoBtn = document.getElementById("openKakaoBtn");
const sideContactBtn = document.getElementById("sideContactBtn");

function openContact(){ contactModal.classList.remove("hidden"); }
contactBtn.onclick = ()=>{
  if(typeof gtag === "function"){
    gtag("event", "click_contact");
  }
  openContact();
};
sideContactBtn.onclick = openContact;
closeContact.onclick = ()=> contactModal.classList.add("hidden");
bindModalClose(contactModal, ()=>contactModal.classList.add("hidden"));
openKakaoBtn.onclick = ()=> window.open(CONTACT_KAKAO, "_blank", "noopener,noreferrer");

/* ====== ì°œ ì „ì²´ ë¹„ìš°ê¸° ====== */
const clearSavedBtn = document.getElementById("clearSavedBtn");
clearSavedBtn.onclick = ()=>{
  if(savedIds.length===0) return showToast("ë¹„ìš¸ ëª©ë¡ì´ ì—†ì–´ìš”");
  if(!confirm("ì°œ ëª©ë¡ì„ ì „ë¶€ ë¹„ìš¸ê¹Œìš”?")) return;
  savedIds = [];
  saveSavedIds();
  renderSaved();
  render();
  showToast("ì „ì²´ ë¹„ì›€");
};

/* âœ… ESC ë‹«ê¸° */
document.addEventListener("keydown",(e)=>{
  if(e.key!=="Escape") return;
  [nickModal, aboutModal, shareModal, contactModal, policyModal, adModal]
    .filter(Boolean)
    .forEach(m=>m.classList.add("hidden"));
});

/* ====== ë¦¬ë Œë” ====== */
function rerenderAll(){
  renderBanner();
  updateModeUI();
  renderDetail();
  render();
  renderSaved();
}

/* ====== ì´ˆê¸° ====== */
applyRoute();
renderSaved();
window.addEventListener("popstate", applyRoute);
window.addEventListener("storage", (event)=>{
  if(event.key === LS_CATEGORY){
    syncCategoriesFromStorage();
    rerenderAll();
  }
});


</script>

<noscript>ë©´ëª©ë™ ì£¼ë¯¼ì´ ì§ì ‘ ì¶”ì²œí•œ ë™ë„¤ ë§›ì§‘ ëª¨ìŒ í˜ì´ì§€ì…ë‹ˆë‹¤.</noscript>

</body>
</html>
